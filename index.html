<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1">
    <title>SideQuest</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#007AFF', // System Blue
                        secondary: '#8E8E93',
                        background: '#F2F2F7', // System Gray 6
                        card: 'rgba(255, 255, 255, 0.8)',
                    },
                    fontFamily: {
                        sans: ['-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'Helvetica', 'Arial', 'sans-serif'],
                    },
                    height: {
                        screen: '100svh', // Override h-screen to use svh (Small Viewport Height) for better mobile support
                    },
                    padding: {
                        'safe-top': 'env(safe-area-inset-top)',
                        'safe-bottom': 'env(safe-area-inset-bottom)',
                        'safe-left': 'env(safe-area-inset-left)',
                        'safe-right': 'env(safe-area-inset-right)',
                    },
                    margin: {
                        'safe-top': 'env(safe-area-inset-top)',
                        'safe-bottom': 'env(safe-area-inset-bottom)',
                    }
                }
            }
        }
    </script>
    <!-- MapLibre GL JS -->
    <script src="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.js"></script>
    <link href="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.css" rel="stylesheet" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="styles/main.css">

    <!-- Firebase SDKs (Modular) -->
    <!-- We will use ES modules in our JS files, so we import them there or use import map if needed. 
         For simplicity with vanilla JS without bundler, we might use script type="module" -->
</head>

<body class="bg-background text-gray-900 overflow-hidden h-screen w-screen selection:bg-primary selection:text-white">

    <!-- Loading Screen -->
    <div id="loading-screen"
        class="fixed inset-0 z-50 flex items-center justify-center bg-white transition-opacity duration-500">
        <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"></div>
    </div>

    <!-- Auth Page -->
    <div id="auth-page" class="hidden fixed inset-0 z-40 flex flex-col items-center justify-center p-6 bg-background">
        <div class="w-full max-w-md bg-white/80 backdrop-blur-xl rounded-2xl shadow-xl p-8 border border-white/20">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-primary mb-2">SideQuest</h1>
                <p class="text-secondary">Connect with neighbors. Get things done.</p>
            </div>

            <!-- Login Form -->
            <form id="login-form" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                    <input type="email" id="login-email"
                        class="w-full px-4 py-3 rounded-xl bg-gray-100 border-transparent focus:bg-white focus:ring-2 focus:ring-primary focus:outline-none transition-all"
                        placeholder="hello@example.com" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                    <input type="password" id="login-password"
                        class="w-full px-4 py-3 rounded-xl bg-gray-100 border-transparent focus:bg-white focus:ring-2 focus:ring-primary focus:outline-none transition-all"
                        placeholder="••••••••" required>
                </div>
                <button type="submit"
                    class="w-full py-3 bg-primary text-white font-semibold rounded-xl shadow-lg hover:shadow-primary/30 transform active:scale-95 transition-all">Sign
                    In</button>
            </form>

            <!-- Signup Form (Hidden initially) -->
            <form id="signup-form" class="hidden space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Name</label>
                    <input type="text" id="signup-name"
                        class="w-full px-4 py-3 rounded-xl bg-gray-100 border-transparent focus:bg-white focus:ring-2 focus:ring-primary focus:outline-none transition-all"
                        placeholder="Your Name" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                    <input type="email" id="signup-email"
                        class="w-full px-4 py-3 rounded-xl bg-gray-100 border-transparent focus:bg-white focus:ring-2 focus:ring-primary focus:outline-none transition-all"
                        placeholder="hello@example.com" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                    <input type="password" id="signup-password"
                        class="w-full px-4 py-3 rounded-xl bg-gray-100 border-transparent focus:bg-white focus:ring-2 focus:ring-primary focus:outline-none transition-all"
                        placeholder="••••••••" required>
                </div>
                <button type="submit"
                    class="w-full py-3 bg-primary text-white font-semibold rounded-xl shadow-lg hover:shadow-primary/30 transform active:scale-95 transition-all">Create
                    Account</button>
            </form>

            <div class="mt-6 text-center">
                <button id="toggle-auth" class="text-sm text-primary font-medium hover:underline">New to SideQuest? Sign
                    Up</button>
            </div>
            <div id="auth-error" class="mt-4 text-center text-red-500 text-sm hidden"></div>
        </div>
    </div>

    <!-- My Tasks Page -->
    <div id="my-tasks-page"
        class="hidden fixed inset-0 z-0 bg-background flex flex-col pt-[calc(1rem+env(safe-area-inset-top))] pb-[calc(6rem+env(safe-area-inset-bottom))] px-4 overflow-y-auto md:z-20 md:inset-y-6 md:right-6 md:left-auto md:w-[450px] md:rounded-3xl md:shadow-2xl md:border md:border-white/20 md:pb-6 md:pt-6">
        <h1 class="text-3xl font-bold mb-6 mt-8 px-2">My Tasks</h1>

        <div class="flex gap-4 mb-6 px-2">
            <button id="tab-posted"
                class="flex-1 py-2 bg-white rounded-lg shadow-sm font-medium text-primary border border-primary">Posted</button>
            <button id="tab-claimed"
                class="flex-1 py-2 bg-white/50 rounded-lg shadow-sm font-medium text-gray-500 border border-transparent">Claimed</button>
        </div>

        <div id="my-tasks-list" class="space-y-4">
            <!-- Task Items injected here -->
            <div class="text-center text-gray-400 mt-10">No tasks found.</div>
        </div>
    </div>

    <!-- Profile Page -->
    <div id="profile-page"
        class="hidden fixed inset-0 z-0 bg-background flex flex-col pt-[calc(2.5rem+env(safe-area-inset-top))] pb-[calc(6rem+env(safe-area-inset-bottom))] px-6 overflow-y-auto md:z-20 md:inset-y-6 md:right-6 md:left-auto md:w-[450px] md:rounded-3xl md:shadow-2xl md:border md:border-white/20 md:pb-6 md:pt-8">

        <div class="flex flex-col items-center mb-8">
            <div
                class="w-24 h-24 bg-white rounded-full shadow-lg flex items-center justify-center text-4xl font-bold text-primary mb-4 border-4 border-white relative">
                <span id="profile-avatar-text">U</span>
                <div id="profile-rating-badge"
                    class="absolute -bottom-2 -right-2 bg-yellow-400 text-white text-sm px-2 py-1 rounded-full font-bold shadow-sm hidden">
                    5.0★</div>
            </div>
            <div class="flex items-center gap-2">
                <h2 id="profile-name" class="text-2xl font-bold text-gray-800">User Name</h2>
                <button id="edit-profile-btn" class="text-gray-400 hover:text-primary transition-colors">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z">
                        </path>
                    </svg>
                </button>
            </div>
            <p id="profile-email" class="text-secondary text-sm">user@example.com</p>

            <!-- Wallet Balance -->
            <div class="mt-4 bg-primary/10 px-6 py-2 rounded-full flex items-center gap-2">
                <span class="text-primary font-bold">Wallet:</span>
                <span id="profile-wallet-balance" class="text-primary font-bold text-xl">₹0</span>
            </div>
        </div>

        <!-- Stats Grid -->
        <div class="grid grid-cols-2 gap-4 mb-8">
            <div class="bg-white p-4 rounded-2xl shadow-sm border border-gray-100 flex flex-col items-center">
                <span id="stat-completed" class="text-2xl font-bold text-primary">0</span>
                <span class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Completed</span>
            </div>
            <div class="bg-white p-4 rounded-2xl shadow-sm border border-gray-100 flex flex-col items-center">
                <span id="stat-posted" class="text-2xl font-bold text-primary">0</span>
                <span class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Posted</span>
            </div>
            <div
                class="bg-white p-4 rounded-2xl shadow-sm border border-gray-100 flex flex-col items-center col-span-2">
                <div class="flex items-center gap-1">
                    <span id="stat-rating" class="text-3xl font-bold text-yellow-400">0.0</span>
                    <span class="text-xl text-gray-300">★</span>
                </div>
                <span class="text-xs text-gray-400 uppercase tracking-wider font-semibold">Average Rating</span>
            </div>
        </div>

        <div class="mt-auto">
            <button id="profile-logout-btn"
                class="w-full py-4 bg-red-50 text-red-500 font-bold rounded-xl border border-red-100 shadow-sm hover:bg-red-100 transition-colors">
                Log Out
            </button>
        </div>
    </div>

    <!-- Edit Profile Modal -->
    <div id="edit-profile-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/40 backdrop-blur-sm transition-opacity" id="edit-profile-backdrop"></div>
        <div
            class="relative w-full max-w-sm bg-white rounded-3xl p-6 shadow-2xl transform scale-100 transition-transform">
            <h3 class="text-xl font-bold mb-4">Edit Profile</h3>
            <input type="text" id="edit-name-input"
                class="w-full px-4 py-3 rounded-xl bg-gray-100 border-transparent focus:bg-white focus:ring-2 focus:ring-primary focus:outline-none mb-4"
                placeholder="Enter new name">
            <div class="flex gap-3">
                <button id="cancel-edit-profile"
                    class="flex-1 py-3 bg-gray-100 text-gray-700 font-semibold rounded-xl">Cancel</button>
                <button id="save-profile-btn"
                    class="flex-1 py-3 bg-primary text-white font-semibold rounded-xl shadow-lg shadow-primary/30">Save</button>
            </div>
        </div>
    </div>

    <!-- App Page (Map & Interface) -->
    <div id="app-page-map" class="fixed inset-0 z-0">
        <!-- Map Container -->
        <div id="map" class="absolute inset-0 w-full h-full"></div>

        <!-- Header / Search -->
        <div
            class="absolute top-[calc(1rem+env(safe-area-inset-top))] left-4 right-4 z-10 flex gap-3 pointer-events-none md:left-28 md:right-auto md:w-96 md:top-6">
            <div
                class="flex-1 bg-white/80 backdrop-blur-md rounded-2xl shadow-lg border border-white/20 pointer-events-auto flex items-center px-4 py-3">
                <svg class="w-5 h-5 text-gray-400 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                </svg>
                <input type="text" id="search-input" placeholder="Search tasks..."
                    class="bg-transparent border-none focus:ring-0 w-full text-gray-800 placeholder-gray-500">
            </div>
        </div>

        <!-- Filter Bar -->
        <div
            class="absolute top-[calc(5rem+env(safe-area-inset-top))] left-4 right-4 z-10 overflow-x-auto pb-2 pointer-events-none md:left-28 md:right-auto md:w-auto md:top-24">
            <div class="flex gap-2 pointer-events-auto" id="filter-container">
                <button data-filter="all"
                    class="filter-chip active bg-primary text-white px-4 py-2 rounded-full shadow-md text-sm font-medium transition-all">All</button>
                <button data-filter="Help"
                    class="filter-chip bg-white/80 backdrop-blur-md text-gray-700 px-4 py-2 rounded-full shadow-sm text-sm font-medium hover:bg-white transition-all">Help</button>
                <button data-filter="Delivery"
                    class="filter-chip bg-white/80 backdrop-blur-md text-gray-700 px-4 py-2 rounded-full shadow-sm text-sm font-medium hover:bg-white transition-all">Delivery</button>
                <button data-filter="Social"
                    class="filter-chip bg-white/80 backdrop-blur-md text-gray-700 px-4 py-2 rounded-full shadow-sm text-sm font-medium hover:bg-white transition-all">Social</button>
            </div>
        </div>

        <!-- Locate Me Button -->
        <button id="locate-btn"
            class="absolute bottom-[calc(10rem+env(safe-area-inset-bottom))] right-6 z-20 w-12 h-12 bg-white text-gray-700 rounded-full shadow-lg border border-gray-200 flex items-center justify-center transform transition-transform hover:scale-110 active:scale-95 md:right-12 md:bottom-12">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
            </svg>
        </button>

        <!-- FAB (Add Task) -->
        <button id="fab-add-task"
            class="absolute bottom-[calc(6rem+env(safe-area-inset-bottom))] right-6 z-20 w-14 h-14 bg-primary text-white rounded-full shadow-lg shadow-primary/40 flex items-center justify-center transform transition-transform hover:scale-110 active:scale-95 md:right-28 md:bottom-10">
            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6">
                </path>
            </svg>
        </button>
    </div>

    <!-- Bottom Navigation -->
    <div
        class="fixed bottom-[calc(1.5rem+env(safe-area-inset-bottom))] left-6 right-6 z-20 md:left-6 md:top-1/2 md:-translate-y-1/2 md:bottom-auto md:w-20 md:flex-col md:h-auto md:py-6 md:rounded-full md:right-auto">
        <div
            class="bg-white/80 backdrop-blur-xl rounded-2xl shadow-lg border border-white/20 flex justify-around p-3 md:flex-col md:gap-8 md:p-4 md:items-center md:rounded-full md:border-none md:shadow-xl md:bg-white/90">
            <button id="nav-explore"
                class="nav-item active text-primary flex flex-col items-center gap-1 transition-colors">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z">
                    </path>
                </svg>
                <span class="text-[10px] font-medium">Explore</span>
            </button>
            <button id="nav-mytasks" class="nav-item text-gray-400 flex flex-col items-center gap-1 transition-colors">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01">
                    </path>
                </svg>
                <span class="text-[10px] font-medium">My Tasks</span>
            </button>
            <button id="nav-profile" class="nav-item text-gray-400 flex flex-col items-center gap-1 transition-colors">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                </svg>
                <span class="text-[10px] font-medium">Profile</span>
            </button>
        </div>
    </div>

    <!-- Create Task Modal -->
    <div id="create-modal" class="hidden fixed inset-0 z-30 pointer-events-none">
        <div class="absolute inset-0 bg-black/20 backdrop-blur-sm transition-opacity opacity-0 pointer-events-auto"
            id="create-modal-backdrop"></div>
        <div class="absolute bottom-0 left-0 right-0 bg-white rounded-t-3xl p-6 pb-[calc(1.5rem+env(safe-area-inset-bottom))] shadow-2xl transform translate-y-full transition-transform duration-300 pointer-events-auto md:inset-0 md:m-auto md:w-[500px] md:h-fit md:rounded-3xl md:translate-y-0 md:shadow-2xl"
            id="create-modal-content">
            <div class="w-12 h-1 bg-gray-300 rounded-full mx-auto mb-6"></div>
            <h2 class="text-xl font-bold mb-4">Post a Task</h2>
            <form id="create-task-form" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Title</label>
                    <input type="text" id="task-title"
                        class="w-full px-4 py-3 rounded-xl bg-gray-100 border-transparent focus:bg-white focus:ring-2 focus:ring-primary focus:outline-none"
                        placeholder="e.g. Move a couch" required>
                </div>
                <div class="flex gap-4">
                    <div class="flex-1">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                        <select id="task-category"
                            class="w-full px-4 py-3 rounded-xl bg-gray-100 border-transparent focus:bg-white focus:ring-2 focus:ring-primary focus:outline-none">
                            <option value="Help">Help</option>
                            <option value="Delivery">Delivery</option>
                            <option value="Social">Social</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="flex-1">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Reward (₹) <span
                                class="text-xs text-gray-400 font-normal">(Optional)</span></label>
                        <input type="number" id="task-reward" min="0"
                            class="w-full px-4 py-3 rounded-xl bg-gray-100 border-transparent focus:bg-white focus:ring-2 focus:ring-primary focus:outline-none"
                            placeholder="15">
                        <p class="text-xs text-gray-500 mt-1 text-right">Balance: <span
                                id="create-task-balance">₹0</span></p>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                    <textarea id="task-desc" rows="3"
                        class="w-full px-4 py-3 rounded-xl bg-gray-100 border-transparent focus:bg-white focus:ring-2 focus:ring-primary focus:outline-none"
                        placeholder="Describe what you need..." required></textarea>
                </div>
                <div class="pt-2 flex gap-3">
                    <button type="button" id="cancel-create"
                        class="flex-1 py-3 bg-gray-100 text-gray-700 font-semibold rounded-xl">Cancel</button>
                    <button type="submit"
                        class="flex-1 py-3 bg-primary text-white font-semibold rounded-xl shadow-lg shadow-primary/30">Post
                        Task</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Task Details Modal (Similar to Create, but for viewing) -->
    <!-- Task Details Modal (Similar to Create, but for viewing) -->
    <div id="task-detail-modal" class="hidden fixed inset-0 z-30 pointer-events-none">
        <div class="absolute inset-0 bg-black/20 backdrop-blur-sm pointer-events-auto" id="detail-modal-backdrop"></div>
        <div class="absolute bottom-0 left-0 right-0 bg-white rounded-t-3xl p-6 pb-[calc(1.5rem+env(safe-area-inset-bottom))] shadow-2xl transform translate-y-full transition-transform duration-300 pointer-events-auto md:inset-0 md:m-auto md:w-[500px] md:h-fit md:rounded-3xl md:translate-y-0 md:shadow-2xl"
            id="detail-modal-content">
            <div class="w-12 h-1 bg-gray-300 rounded-full mx-auto mb-6"></div>

            <div class="flex items-center gap-4 mb-6">
                <div id="detail-avatar"
                    class="w-12 h-12 rounded-full bg-gray-200 flex items-center justify-center font-bold text-gray-500">
                    U</div>
                <div>
                    <h3 id="detail-poster-name" class="font-bold text-lg">Poster Name</h3>
                    <p id="detail-time-dist" class="text-sm text-gray-500">2 min ago • 0.5 km away</p>
                </div>
                <div class="ml-auto">
                    <span id="detail-price"
                        class="bg-green-100 text-green-700 px-3 py-1 rounded-full font-bold">₹15</span>
                </div>
            </div>

            <h2 id="detail-title" class="text-2xl font-bold mb-2">Task Title</h2>
            <p id="detail-desc" class="text-gray-600 mb-6 leading-relaxed">Description goes here...</p>

            <button id="claim-btn"
                class="w-full py-4 bg-primary text-white font-bold text-lg rounded-xl shadow-xl shadow-primary/30 hover:scale-[1.02] transition-transform">
                I'll do it!
            </button>
            <button id="delete-btn"
                class="hidden w-full py-4 bg-red-500 text-white font-bold text-lg rounded-xl shadow-xl shadow-red-500/30">
                Delete Task
            </button>
        </div>
    </div>

    <!-- Rating Modal -->
    <div id="rating-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/40 backdrop-blur-sm transition-opacity" id="rating-modal-backdrop"></div>
        <div
            class="relative w-full max-w-sm bg-white rounded-3xl p-6 shadow-2xl transform scale-100 transition-transform">
            <h3 class="text-xl font-bold text-center mb-2">Rate your experience</h3>
            <p class="text-gray-500 text-center text-sm mb-6">How was the task completion?</p>

            <div class="flex justify-center gap-2 mb-8" id="star-container">
                <button data-value="1"
                    class="star-btn text-4xl text-gray-300 hover:scale-110 transition-transform">★</button>
                <button data-value="2"
                    class="star-btn text-4xl text-gray-300 hover:scale-110 transition-transform">★</button>
                <button data-value="3"
                    class="star-btn text-4xl text-gray-300 hover:scale-110 transition-transform">★</button>
                <button data-value="4"
                    class="star-btn text-4xl text-gray-300 hover:scale-110 transition-transform">★</button>
                <button data-value="5"
                    class="star-btn text-4xl text-gray-300 hover:scale-110 transition-transform">★</button>
            </div>

            <button id="submit-rating-btn" disabled
                class="w-full py-3 bg-gray-200 text-gray-400 font-bold rounded-xl transition-colors">
                Confirm & Rate
            </button>
            <button id="cancel-rating-btn"
                class="w-full mt-3 py-3 text-gray-500 font-medium hover:bg-gray-50 rounded-xl">
                Skip / Cancel
            </button>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container"
        class="fixed top-[calc(1rem+env(safe-area-inset-top))] left-0 right-0 z-[60] flex flex-col items-center gap-2 pointer-events-none">
        <!-- Toasts injected here -->
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmation-modal" class="hidden fixed inset-0 z-[70] flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/40 backdrop-blur-sm transition-opacity opacity-0" id="confirm-backdrop">
        </div>
        <div class="relative w-full max-w-xs bg-white rounded-2xl p-6 shadow-2xl transform scale-95 opacity-0 transition-all duration-200"
            id="confirm-content">
            <h3 id="confirm-title" class="text-xl font-bold mb-2 text-gray-900">Confirm</h3>
            <p id="confirm-message" class="text-gray-500 text-sm mb-6 leading-relaxed">Are you sure?</p>
            <div class="flex gap-3">
                <button id="confirm-no-btn"
                    class="flex-1 py-2.5 bg-gray-100 text-gray-700 font-semibold rounded-xl hover:bg-gray-200 transition-colors">Cancel</button>
                <button id="confirm-yes-btn"
                    class="flex-1 py-2.5 bg-red-500 text-white font-semibold rounded-xl shadow-lg shadow-red-500/30 hover:bg-red-600 transition-colors">Yes,
                    Do it</button>
            </div>
        </div>
    </div>
    <script type="module" src="js/firebase-config.js"></script>
    <script type="module" src="js/auth.js"></script>
    <!-- Map and Tasks will need to wait for Auth, so we might orchestrate in app.js -->
    <script type="module" src="js/map.js"></script>
    <script type="module" src="js/tasks.js"></script>
    <script type="module" src="js/app.js"></script>
</body>

</html>